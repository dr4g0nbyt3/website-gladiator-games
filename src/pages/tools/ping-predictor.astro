---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
---

<Layout
  title="Ping Predictor - Gladiator Games"
  description="Check expected ping and latency for popular games from Jefferson City, Missouri. Compare home internet vs gaming center performance."
>
  <Header />
  <main>
    <!-- Hero Section -->
    <section class="py-16 md:py-24 bg-brand-black">
      <div class="container-custom">
        <div class="max-w-4xl mx-auto">
          <div class="text-center mb-8">
            <a href="/tools" class="text-brand-orange hover:brightness-110 inline-flex items-center mb-4">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
              Back to Tools
            </a>
            <h1 class="text-4xl md:text-5xl font-bold mb-4 text-brand-white">
              Ping Predictor
            </h1>
            <p class="text-brand-gray text-lg">
              Check your expected latency for popular competitive games
            </p>
          </div>

          <!-- Location Selection -->
          <div class="card mb-8">
            <h2 class="text-2xl font-bold mb-4 text-brand-white">Your Location</h2>
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block text-brand-white text-xs font-semibold uppercase tracking-wider mb-3">Connection Type</label>
                <select id="connection-type" class="w-full appearance-none bg-gradient-to-br from-brand-gray-dark to-brand-black border border-brand-gray/30 hover:border-brand-orange text-gray-200 px-5 py-4 rounded-xl shadow-lg shadow-black/20 focus:outline-none focus:ring-2 focus:ring-brand-orange/50 focus:border-brand-orange transition-all duration-300 cursor-pointer text-base font-medium backdrop-blur-sm" style="background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%23ff6900%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1.25em; padding-right: 3rem; color-scheme: dark;">
                  <option value="home" class="bg-brand-gray-dark text-gray-200">Home Internet</option>
                  <option value="gladiator" class="bg-brand-gray-dark text-gray-200">Gladiator Games</option>
                  <option value="mobile" class="bg-brand-gray-dark text-gray-200">Mobile Hotspot</option>
                  <option value="public" class="bg-brand-gray-dark text-gray-200">Public WiFi</option>
                </select>
              </div>
              <div>
                <label class="block text-brand-white text-xs font-semibold uppercase tracking-wider mb-3">ISP (Optional)</label>
                <select id="isp" class="w-full appearance-none bg-gradient-to-br from-brand-gray-dark to-brand-black border border-brand-gray/30 hover:border-brand-orange text-gray-200 px-5 py-4 rounded-xl shadow-lg shadow-black/20 focus:outline-none focus:ring-2 focus:ring-brand-orange/50 focus:border-brand-orange transition-all duration-300 cursor-pointer text-base font-medium backdrop-blur-sm" style="background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%23ff6900%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1.25em; padding-right: 3rem; color-scheme: dark;">
                  <option value="" class="bg-brand-gray-dark text-gray-200">Select ISP...</option>
                  <option value="spectrum" class="bg-brand-gray-dark text-gray-200">Spectrum</option>
                  <option value="att" class="bg-brand-gray-dark text-gray-200">AT&T</option>
                  <option value="socket" class="bg-brand-gray-dark text-gray-200">Socket Telecom</option>
                  <option value="centurylink" class="bg-brand-gray-dark text-gray-200">CenturyLink</option>
                  <option value="tmobile" class="bg-brand-gray-dark text-gray-200">T-Mobile Home Internet</option>
                  <option value="verizon" class="bg-brand-gray-dark text-gray-200">Verizon</option>
                  <option value="other" class="bg-brand-gray-dark text-gray-200">Other</option>
                </select>
              </div>
            </div>
            <button id="check-ping-btn" class="btn-primary bg-brand-orange hover:bg-brand-orange-hover mt-4">
              Check Ping
            </button>
          </div>

          <!-- Results -->
          <div id="ping-results" class="hidden">
            <!-- Comparison Card -->
            <div class="card mb-8 bg-gradient-to-r from-brand-orange/10 to-brand-purple/10 border-brand-orange/30">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-lg font-bold text-brand-white mb-2">At Gladiator Games</h3>
                  <p class="text-brand-gray text-sm">Typical latency: <span class="text-brand-orange font-bold text-xl">24ms</span></p>
                </div>
                <a href="/visit" class="btn-primary bg-brand-orange hover:bg-brand-orange-hover">
                  Visit Us
                </a>
              </div>
            </div>

            <!-- Game Results -->
            <div class="card mb-8">
              <h2 class="text-2xl font-bold mb-6 text-brand-white">Expected Ping by Game</h2>
              <div class="space-y-4" id="game-results"></div>
            </div>

            <!-- Time of Day Analysis -->
            <div class="card mb-8">
              <h2 class="text-2xl font-bold mb-4 text-brand-white">Best Time to Play</h2>
              <p class="text-brand-gray mb-4">Peak gaming hours and expected latency fluctuation</p>
              <div class="grid md:grid-cols-3 gap-4">
                <div class="bg-brand-gray-dark/30 rounded-lg p-4 text-center">
                  <div class="text-2xl font-bold text-green-500 mb-2">Morning</div>
                  <p class="text-brand-gray text-sm">6AM - 12PM</p>
                  <p class="text-brand-white font-bold mt-2">Best</p>
                  <p class="text-brand-gray text-xs">Lowest traffic</p>
                </div>
                <div class="bg-brand-gray-dark/30 rounded-lg p-4 text-center">
                  <div class="text-2xl font-bold text-yellow-500 mb-2">Afternoon</div>
                  <p class="text-brand-gray text-sm">12PM - 6PM</p>
                  <p class="text-brand-white font-bold mt-2">Good</p>
                  <p class="text-brand-gray text-xs">Moderate traffic</p>
                </div>
                <div class="bg-brand-gray-dark/30 rounded-lg p-4 text-center">
                  <div class="text-2xl font-bold text-orange-500 mb-2">Evening</div>
                  <p class="text-brand-gray text-sm">6PM - 12AM</p>
                  <p class="text-brand-white font-bold mt-2">Peak</p>
                  <p class="text-brand-gray text-xs">Highest traffic</p>
                </div>
              </div>
            </div>

            <!-- Recommendations -->
            <div class="card">
              <h2 class="text-2xl font-bold mb-4 text-brand-white">Recommendations</h2>
              <div id="recommendations-content"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-20 bg-gradient-to-b from-brand-black to-brand-gray-dark">
      <div class="container-custom">
        <div class="max-w-4xl mx-auto">
          <div class="bg-gradient-to-r from-brand-orange/10 via-brand-purple/10 to-brand-cyan/10 rounded-lg p-6 border border-brand-orange/30">
            <div class="flex items-center justify-center mb-4">
              <div class="w-3 h-3 bg-brand-orange rounded-full animate-pulse mr-2"></div>
              <h2 class="text-2xl md:text-3xl font-bold text-brand-white">Experience Low-Ping Gaming</h2>
            </div>
            <p class="text-brand-gray text-center mb-6">
              At Gladiator Games, enjoy consistent 24ms ping with our enterprise-grade internet and wired connections
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
              <a href="/visit" class="btn-primary bg-brand-orange-hover hover:bg-brand-orange">
                Visit Us Today
              </a>
              <a href="/tools" class="btn-primary bg-brand-black border-2 border-brand-orange-hover text-brand-orange-hover hover:bg-brand-orange-hover hover:text-brand-white">
                More Tools
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  <Footer />
</Layout>

<script>
  interface GameServer {
    name: string;
    server: string;
    location: string;
    basePing: number;
    icon: string;
  }

  const gameServers: GameServer[] = [
    { name: 'Valorant', server: 'NA Central', location: 'Chicago, IL', basePing: 28, icon: 'val' },
    { name: 'League of Legends', server: 'NA', location: 'Chicago, IL', basePing: 26, icon: 'lol' },
    { name: 'Counter-Strike 2', server: 'US Central', location: 'Chicago, IL', basePing: 25, icon: 'cs2' },
    { name: 'Apex Legends', server: 'St. Louis', location: 'St. Louis, MO', basePing: 18, icon: 'apex' },
    { name: 'Fortnite', server: 'NAE', location: 'Virginia', basePing: 45, icon: 'fn' },
    { name: 'Rocket League', server: 'US-Central', location: 'Dallas, TX', basePing: 35, icon: 'rl' },
    { name: 'Dota 2', server: 'US East', location: 'Virginia', basePing: 48, icon: 'dota' },
    { name: 'Overwatch 2', server: 'Central', location: 'Chicago, IL', basePing: 27, icon: 'ow' },
  ];

  function calculatePing(basePing: number, connectionType: string, isp: string): number {
    let ping = basePing;

    // Connection type modifiers
    switch (connectionType) {
      case 'home':
        ping += 15; // Average home internet overhead
        break;
      case 'gladiator':
        ping += 0; // Optimized connection
        break;
      case 'mobile':
        ping += 45; // Mobile hotspot penalty
        break;
      case 'public':
        ping += 35; // Public WiFi penalty
        break;
    }

    // ISP modifiers
    switch (isp) {
      case 'spectrum':
        ping += 5;
        break;
      case 'att':
        ping += 8;
        break;
      case 'socket':
        ping += 3; // Local fiber
        break;
      case 'centurylink':
        ping += 12;
        break;
      case 'tmobile':
        ping += 20;
        break;
      case 'verizon':
        ping += 18;
        break;
      case 'other':
        ping += 10;
        break;
    }

    return Math.round(ping);
  }

  function getPingQuality(ping: number): { text: string; color: string } {
    if (ping < 30) return { text: 'Excellent', color: 'green' };
    if (ping < 50) return { text: 'Good', color: 'yellow' };
    if (ping < 80) return { text: 'Fair', color: 'orange' };
    return { text: 'Poor', color: 'red' };
  }

  function generateRecommendations(connectionType: string, avgPing: number): string {
    const recs: string[] = [];

    if (avgPing > 60) {
      recs.push('Your ping is higher than optimal for competitive gaming. Consider visiting Gladiator Games for a better connection.');
    }

    if (connectionType === 'mobile' || connectionType === 'public') {
      recs.push('Mobile and public WiFi connections are not ideal for competitive gaming. Use a wired connection for best results.');
    }

    if (connectionType === 'home') {
      recs.push('For home gaming, use a wired ethernet connection instead of WiFi when possible.');
      recs.push('Close background applications and downloads while gaming to reduce latency.');
    }

    if (avgPing < 30) {
      recs.push('Your connection is excellent for competitive gaming! You have a competitive advantage.');
    }

    recs.push('At Gladiator Games, we maintain an average of 24ms ping with wired connections and enterprise-grade internet.');

    return recs.map(rec => `
      <div class="flex items-start mb-3">
        <svg class="w-5 h-5 text-brand-orange mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span class="text-brand-gray">${rec}</span>
      </div>
    `).join('');
  }

  document.getElementById('check-ping-btn')?.addEventListener('click', () => {
    const connectionType = (document.getElementById('connection-type') as HTMLSelectElement).value;
    const isp = (document.getElementById('isp') as HTMLSelectElement).value;

    // Calculate pings for all games
    const results = gameServers.map(game => ({
      ...game,
      ping: calculatePing(game.basePing, connectionType, isp),
    }));

    // Display results
    const resultsContainer = document.getElementById('game-results')!;
    resultsContainer.innerHTML = results.map(game => {
      const quality = getPingQuality(game.ping);
      return `
        <div class="flex items-center justify-between p-4 bg-brand-gray-dark/30 rounded-lg">
          <div class="flex items-center flex-1">
            <div class="w-12 h-12 bg-brand-gray-dark rounded-lg flex items-center justify-center mr-4">
              <span class="text-brand-orange font-bold text-xs">${game.icon.toUpperCase()}</span>
            </div>
            <div class="flex-1">
              <h4 class="font-bold text-brand-white">${game.name}</h4>
              <p class="text-brand-gray text-sm">${game.server} â€¢ ${game.location}</p>
            </div>
          </div>
          <div class="text-right">
            <div class="text-2xl font-bold text-${quality.color}-500">${game.ping}ms</div>
            <div class="text-sm text-${quality.color}-500">${quality.text}</div>
          </div>
        </div>
      `;
    }).join('');

    // Calculate average ping
    const avgPing = Math.round(results.reduce((sum, game) => sum + game.ping, 0) / results.length);

    // Show recommendations
    const recommendationsEl = document.getElementById('recommendations-content')!;
    recommendationsEl.innerHTML = generateRecommendations(connectionType, avgPing);

    // Show results section
    document.getElementById('ping-results')!.classList.remove('hidden');

    // Scroll to results
    document.getElementById('ping-results')!.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
</script>
</Layout>
